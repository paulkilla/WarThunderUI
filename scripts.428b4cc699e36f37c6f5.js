!function(e){"use strict";var t=function(e,n,r){return 1===arguments.length?t.get(e):t.set(e,n,r)};t._document=document,t._navigator=navigator,t.defaults={path:"/"},t.get=function(e){return t._cachedDocumentCookie!==t._document.cookie&&t._renewCache(),t._cache[e]},t.set=function(n,r,i){return(i=t._getExtendedOptions(i)).expires=t._getExpiresDate(r===e?-1:i.expires),t._document.cookie=t._generateCookieString(n,r,i),t},t.expire=function(n,r){return t.set(n,e,r)},t._getExtendedOptions=function(n){return{path:n&&n.path||t.defaults.path,domain:n&&n.domain||t.defaults.domain,expires:n&&n.expires||t.defaults.expires,secure:n&&n.secure!==e?n.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){switch(n=n||new Date,typeof e){case"number":e=new Date(n.getTime()+1e3*e);break;case"string":e=new Date(e)}if(e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){var r=(e=encodeURIComponent(e))+"="+(t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent));return r+=(n=n||{}).path?";path="+n.path:"",r+=n.domain?";domain="+n.domain:"",(r+=n.expires?";expires="+n.expires.toGMTString():"")+(n.secure?";secure":"")},t._getCookieObjectFromString=function(n){for(var r={},i=n?n.split("; "):[],a=0;a<i.length;a++){var o=t._getKeyValuePairFromCookieString(i[a]);r[o.key]===e&&(r[o.key]=o.value)}return r},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");return t=t<0?e.length:t,{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}},t._renewCache=function(){t._cache=t._getCookieObjectFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){return t._navigator.cookieEnabled||"1"===t.set("cookies.js",1).get("cookies.js")},t.enabled=t._areEnabled(),"function"==typeof define&&define.amd?define(function(){return t}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.Cookies=t):window.Cookies=t}();var Sylvester={version:"0.1.3",precision:1e-6};function Vector(){}function Matrix(){}function Line(){}function Plane(){}Vector.prototype={e:function(e){return e<1||e>this.elements.length?null:this.elements[e-1]},at:function(e){return e<0||e>=this.elements.length?null:this.elements[e]},dimensions:function(){return this.elements.length},modulus:function(){return Math.sqrt(this.dot(this))},eql:function(e){var t=this.elements.length,n=e.elements||e;if(t!=n.length)return!1;do{if(Math.abs(this.elements[t-1]-n[t-1])>Sylvester.precision)return!1}while(--t);return!0},dup:function(){return Vector.create(this.elements)},map:function(e){var t=[];return this.each(function(n,r){t.push(e(n,r))}),Vector.create(t)},each:function(e){var t,n=this.elements.length,r=n;do{e(this.elements[t=r-n],t+1)}while(--n)},toUnitVector:function(){var e=this.modulus();return 0===e?this.dup():this.map(function(t){return t/e})},angleFrom:function(e){var t=e.elements||e;if(this.elements.length!=t.length)return null;var n=0,r=0,i=0;if(this.each(function(e,a){n+=e*t[a-1],r+=e*e,i+=t[a-1]*t[a-1]}),r=Math.sqrt(r),i=Math.sqrt(i),r*i==0)return null;var a=n/(r*i);return a<-1&&(a=-1),a>1&&(a=1),Math.acos(a)},signedAngle2DFrom:function(e){var t=this.elements,n=e.elements||e;return 2!=n.length||2!=t.length?null:Math.atan2(n[0]*t[1]-n[1]*t[0],n[0]*t[0]+n[1]*t[1])},isParallelTo:function(e){var t=this.angleFrom(e);return null===t?null:t<=Sylvester.precision},isAntiparallelTo:function(e){var t=this.angleFrom(e);return null===t?null:Math.abs(t-Math.PI)<=Sylvester.precision},isPerpendicularTo:function(e){var t=this.dot(e);return null===t?null:Math.abs(t)<=Sylvester.precision},add:function(e){var t=e.elements||e;return this.elements.length!=t.length?null:this.map(function(e,n){return e+t[n-1]})},subtract:function(e){var t=e.elements||e;return this.elements.length!=t.length?null:this.map(function(e,n){return e-t[n-1]})},multiply:function(e){return this.map(function(t){return t*e})},x:function(e){return this.multiply(e)},dot:function(e){var t=e.elements||e,n=0,r=this.elements.length;if(r!=t.length)return null;do{n+=this.elements[r-1]*t[r-1]}while(--r);return n},cross:function(e){var t=e.elements||e;if(3!=this.elements.length||3!=t.length)return null;var n=this.elements;return Vector.create([n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]])},max:function(){var e,t=0,n=this.elements.length,r=n;do{e=r-n,Math.abs(this.elements[e])>Math.abs(t)&&(t=this.elements[e])}while(--n);return t},indexOf:function(e){var t,n=null,r=this.elements.length,i=r;do{t=i-r,null===n&&this.elements[t]==e&&(n=t+1)}while(--r);return n},toDiagonalMatrix:function(){return Matrix.Diagonal(this.elements)},round:function(){return this.map(function(e){return Math.round(e)})},snapTo:function(e){return this.map(function(t){return Math.abs(t-e)<=Sylvester.precision?e:t})},distanceFrom:function(e){if(e.anchor)return e.distanceFrom(this);var t=e.elements||e;if(t.length!=this.elements.length)return null;var n,r=0;return this.each(function(e,i){r+=(n=e-t[i-1])*n}),Math.sqrt(r)},liesOn:function(e){return e.contains(this)},liesIn:function(e){return e.contains(this)},rotate:function(e,t){var n,r,i,a,o;switch(this.elements.length){case 2:return 2!=(n=t.elements||t).length?null:(r=Matrix.Rotation(e).elements,Vector.create([n[0]+r[0][0]*(i=this.elements[0]-n[0])+r[0][1]*(a=this.elements[1]-n[1]),n[1]+r[1][0]*i+r[1][1]*a]));case 3:if(!t.direction)return null;var s=t.pointClosestTo(this).elements;return r=Matrix.Rotation(e,t.direction).elements,Vector.create([s[0]+r[0][0]*(i=this.elements[0]-s[0])+r[0][1]*(a=this.elements[1]-s[1])+r[0][2]*(o=this.elements[2]-s[2]),s[1]+r[1][0]*i+r[1][1]*a+r[1][2]*o,s[2]+r[2][0]*i+r[2][1]*a+r[2][2]*o]);default:return null}},reflectionIn:function(e){if(e.anchor){var t=this.elements.slice(),n=e.pointClosestTo(t).elements;return Vector.create([n[0]+(n[0]-t[0]),n[1]+(n[1]-t[1]),n[2]+(n[2]-(t[2]||0))])}var r=e.elements||e;return this.elements.length!=r.length?null:this.map(function(e,t){return r[t-1]+(r[t-1]-e)})},to3D:function(){var e=this.dup();switch(e.elements.length){case 3:break;case 2:e.elements.push(0);break;default:return null}return e},inspect:function(){return"["+this.elements.join(", ")+"]"},setElements:function(e){return this.elements=(e.elements||e).slice(),this}},Vector.create=function(e){return(new Vector).setElements(e)},Vector.i=Vector.create([1,0,0]),Vector.j=Vector.create([0,1,0]),Vector.k=Vector.create([0,0,1]),Vector.Random=function(e){var t=[];do{t.push(Math.random())}while(--e);return Vector.create(t)},Vector.Zero=function(e){var t=[];do{t.push(0)}while(--e);return Vector.create(t)},Matrix.prototype={e:function(e,t){return e<1||e>this.elements.length||t<1||t>this.elements[0].length?null:this.elements[e-1][t-1]},row:function(e){return e>this.elements.length?null:Vector.create(this.elements[e-1])},col:function(e){if(e>this.elements[0].length)return null;var t=[],n=this.elements.length,r=n;do{t.push(this.elements[r-n][e-1])}while(--n);return Vector.create(t)},dimensions:function(){return{rows:this.elements.length,cols:this.elements[0].length}},rows:function(){return this.elements.length},cols:function(){return this.elements[0].length},eql:function(e){var t=e.elements||e;if(void 0===t[0][0]&&(t=Matrix.create(t).elements),this.elements.length!=t.length||this.elements[0].length!=t[0].length)return!1;var n,r,i,a=this.elements.length,o=a,s=this.elements[0].length;do{n=o-a,r=s;do{if(i=s-r,Math.abs(this.elements[n][i]-t[n][i])>Sylvester.precision)return!1}while(--r)}while(--a);return!0},dup:function(){return Matrix.create(this.elements)},map:function(e){var t,n,r,i=[],a=this.elements.length,o=a,s=this.elements[0].length;do{n=s,i[t=o-a]=[];do{i[t][r=s-n]=e(this.elements[t][r],t+1,r+1)}while(--n)}while(--a);return Matrix.create(i)},isSameSizeAs:function(e){var t=e.elements||e;return void 0===t[0][0]&&(t=Matrix.create(t).elements),this.elements.length==t.length&&this.elements[0].length==t[0].length},add:function(e){var t=e.elements||e;return void 0===t[0][0]&&(t=Matrix.create(t).elements),this.isSameSizeAs(t)?this.map(function(e,n,r){return e+t[n-1][r-1]}):null},subtract:function(e){var t=e.elements||e;return void 0===t[0][0]&&(t=Matrix.create(t).elements),this.isSameSizeAs(t)?this.map(function(e,n,r){return e-t[n-1][r-1]}):null},canMultiplyFromLeft:function(e){var t=e.elements||e;return void 0===t[0][0]&&(t=Matrix.create(t).elements),this.elements[0].length==t.length},multiply:function(e){if(!e.elements)return this.map(function(t){return t*e});var t=!!e.modulus;if(void 0===(p=e.elements||e)[0][0]&&(p=Matrix.create(p).elements),!this.canMultiplyFromLeft(p))return null;var n,r,i,a,o,s,l=this.elements.length,c=l,u=p[0].length,h=this.elements[0].length,m=[];do{m[n=c-l]=[],r=u;do{i=u-r,a=0,o=h;do{a+=this.elements[n][s=h-o]*p[s][i]}while(--o);m[n][i]=a}while(--r)}while(--l);var p=Matrix.create(m);return t?p.col(1):p},x:function(e){return this.multiply(e)},minor:function(e,t,n,r){var i,a,o,s=[],l=n,c=this.elements.length,u=this.elements[0].length;do{s[i=n-l]=[],a=r;do{s[i][o=r-a]=this.elements[(e+i-1)%c][(t+o-1)%u]}while(--a)}while(--l);return Matrix.create(s)},transpose:function(){var e,t,n,r=this.elements.length,i=this.elements[0].length,a=[],o=i;do{a[e=i-o]=[],t=r;do{a[e][n=r-t]=this.elements[n][e]}while(--t)}while(--o);return Matrix.create(a)},isSquare:function(){return this.elements.length==this.elements[0].length},max:function(){var e,t,n,r=0,i=this.elements.length,a=i,o=this.elements[0].length;do{e=a-i,t=o;do{n=o-t,Math.abs(this.elements[e][n])>Math.abs(r)&&(r=this.elements[e][n])}while(--t)}while(--i);return r},indexOf:function(e){var t,n,r,i=this.elements.length,a=i,o=this.elements[0].length;do{t=a-i,n=o;do{if(this.elements[t][r=o-n]==e)return{i:t+1,j:r+1}}while(--n)}while(--i);return null},diagonal:function(){if(!this.isSquare)return null;var e,t=[],n=this.elements.length,r=n;do{t.push(this.elements[e=r-n][e])}while(--n);return Vector.create(t)},toRightTriangular:function(){var e,t,n,r,i=this.dup(),a=this.elements.length,o=a,s=this.elements[0].length;do{if(0==i.elements[t=o-a][t])for(j=t+1;j<o;j++)if(0!=i.elements[j][t]){e=[],n=s;do{e.push(i.elements[t][r=s-n]+i.elements[j][r])}while(--n);i.elements[t]=e;break}if(0!=i.elements[t][t])for(j=t+1;j<o;j++){var l=i.elements[j][t]/i.elements[t][t];e=[],n=s;do{e.push((r=s-n)<=t?0:i.elements[j][r]-i.elements[t][r]*l)}while(--n);i.elements[j]=e}}while(--a);return i},toUpperTriangular:function(){return this.toRightTriangular()},determinant:function(){if(!this.isSquare())return null;var e,t=this.toRightTriangular(),n=t.elements[0][0],r=t.elements.length-1,i=r;do{n*=t.elements[e=i-r+1][e]}while(--r);return n},det:function(){return this.determinant()},isSingular:function(){return this.isSquare()&&0===this.determinant()},trace:function(){if(!this.isSquare())return null;var e,t=this.elements[0][0],n=this.elements.length-1,r=n;do{t+=this.elements[e=r-n+1][e]}while(--n);return t},tr:function(){return this.trace()},rank:function(){var e,t,n=this.toRightTriangular(),r=0,i=this.elements.length,a=i,o=this.elements[0].length;do{e=a-i,t=o;do{if(Math.abs(n.elements[e][o-t])>Sylvester.precision){r++;break}}while(--t)}while(--i);return r},rk:function(){return this.rank()},augment:function(e){var t=e.elements||e;void 0===t[0][0]&&(t=Matrix.create(t).elements);var n,r,i,a=this.dup(),o=a.elements[0].length,s=a.elements.length,l=s,c=t[0].length;if(s!=t.length)return null;do{n=l-s,r=c;do{a.elements[n][o+(i=c-r)]=t[n][i]}while(--r)}while(--s);return a},inverse:function(){if(!this.isSquare()||this.isSingular())return null;var e,t,n,r,i,a,o,s=this.elements.length,l=s,c=this.augment(Matrix.I(s)).toRightTriangular(),u=c.elements[0].length,h=[];do{i=[],n=u,h[e=s-1]=[],a=c.elements[e][e];do{i.push(o=c.elements[e][r=u-n]/a),r>=l&&h[e].push(o)}while(--n);for(c.elements[e]=i,t=0;t<e;t++){i=[],n=u;do{i.push(c.elements[t][r=u-n]-c.elements[e][r]*c.elements[t][e])}while(--n);c.elements[t]=i}}while(--s);return Matrix.create(h)},inv:function(){return this.inverse()},round:function(){return this.map(function(e){return Math.round(e)})},snapTo:function(e){return this.map(function(t){return Math.abs(t-e)<=Sylvester.precision?e:t})},inspect:function(){var e=[],t=this.elements.length,n=t;do{e.push(Vector.create(this.elements[n-t]).inspect())}while(--t);return e.join("\n")},setElements:function(e){var t,n=e.elements||e;if(void 0!==n[0][0]){var r,i,a,o=n.length,s=o;this.elements=[];do{i=r=n[t=s-o].length,this.elements[t]=[];do{this.elements[t][a=i-r]=n[t][a]}while(--r)}while(--o);return this}var l=n.length,c=l;this.elements=[];do{this.elements.push([n[t=c-l]])}while(--l);return this}},Matrix.create=function(e){return(new Matrix).setElements(e)},Matrix.I=function(e){var t,n,r,i=[],a=e;do{i[t=a-e]=[],n=a;do{i[t][r=a-n]=t==r?1:0}while(--n)}while(--e);return Matrix.create(i)},Matrix.Diagonal=function(e){var t,n=e.length,r=n,i=Matrix.I(n);do{i.elements[t=r-n][t]=e[t]}while(--n);return i},Matrix.Rotation=function(e,t){if(!t)return Matrix.create([[Math.cos(e),-Math.sin(e)],[Math.sin(e),Math.cos(e)]]);var n=t.dup();if(3!=n.elements.length)return null;var r=n.modulus(),i=n.elements[0]/r,a=n.elements[1]/r,o=n.elements[2]/r,s=Math.sin(e),l=Math.cos(e),c=1-l;return Matrix.create([[c*i*i+l,c*i*a-s*o,c*i*o+s*a],[c*i*a+s*o,c*a*a+l,c*a*o-s*i],[c*i*o-s*a,c*a*o+s*i,c*o*o+l]])},Matrix.RotationX=function(e){var t=Math.cos(e),n=Math.sin(e);return Matrix.create([[1,0,0],[0,t,-n],[0,n,t]])},Matrix.RotationY=function(e){var t=Math.cos(e),n=Math.sin(e);return Matrix.create([[t,0,n],[0,1,0],[-n,0,t]])},Matrix.RotationZ=function(e){var t=Math.cos(e),n=Math.sin(e);return Matrix.create([[t,-n,0],[n,t,0],[0,0,1]])},Matrix.Random=function(e,t){return Matrix.Zero(e,t).map(function(){return Math.random()})},Matrix.Zero=function(e,t){var n,r,i=[],a=e;do{i[n=e-a]=[],r=t;do{i[n][t-r]=0}while(--r)}while(--a);return Matrix.create(i)},Line.prototype={eql:function(e){return this.isParallelTo(e)&&this.contains(e.anchor)},dup:function(){return Line.create(this.anchor,this.direction)},translate:function(e){var t=e.elements||e;return Line.create([this.anchor.elements[0]+t[0],this.anchor.elements[1]+t[1],this.anchor.elements[2]+(t[2]||0)],this.direction)},isParallelTo:function(e){if(e.normal)return e.isParallelTo(this);var t=this.direction.angleFrom(e.direction);return Math.abs(t)<=Sylvester.precision||Math.abs(t-Math.PI)<=Sylvester.precision},distanceFrom:function(e){if(e.normal)return e.distanceFrom(this);if(e.direction){if(this.isParallelTo(e))return this.distanceFrom(e.anchor);var t=this.direction.cross(e.direction).toUnitVector().elements,n=this.anchor.elements,r=e.anchor.elements;return Math.abs((n[0]-r[0])*t[0]+(n[1]-r[1])*t[1]+(n[2]-r[2])*t[2])}var i=e.elements||e,a=this.direction.elements,o=i[0]-(n=this.anchor.elements)[0],s=i[1]-n[1],l=(i[2]||0)-n[2],c=Math.sqrt(o*o+s*s+l*l);if(0===c)return 0;var u=(o*a[0]+s*a[1]+l*a[2])/c,h=1-u*u;return Math.abs(c*Math.sqrt(h<0?0:h))},contains:function(e){var t=this.distanceFrom(e);return null!==t&&t<=Sylvester.precision},liesIn:function(e){return e.contains(this)},intersects:function(e){return e.normal?e.intersects(this):!this.isParallelTo(e)&&this.distanceFrom(e)<=Sylvester.precision},intersectionWith:function(e){if(e.normal)return e.intersectionWith(this);if(!this.intersects(e))return null;var t=this.anchor.elements,n=this.direction.elements,r=e.anchor.elements,i=e.direction.elements,a=n[0],o=n[1],s=n[2],l=i[0],c=i[1],u=i[2],h=t[0]-r[0],m=t[1]-r[1],p=t[2]-r[2],d=l*l+c*c+u*u,f=a*l+o*c+s*u,g=((-a*h-o*m-s*p)*d/(a*a+o*o+s*s)+f*(l*h+c*m+u*p))/(d-f*f);return Vector.create([t[0]+g*a,t[1]+g*o,t[2]+g*s])},pointClosestTo:function(e){if(e.direction){if(this.intersects(e))return this.intersectionWith(e);if(this.isParallelTo(e))return null;var t=e.direction.elements,n=t[0],r=t[1],i=t[2],a=Vector.create([(h=(u=(s=this.direction.elements)[2])*n-(l=s[0])*i)*i-(m=l*r-(c=s[1])*n)*r,m*n-(p=c*i-u*r)*i,p*r-h*n]);return(o=Plane.create(e.anchor,a)).intersectionWith(this)}var o;if(this.contains(o=e.elements||e))return Vector.create(o);var s,l,c,u,h,m,p,d=this.anchor.elements,f=d[0],g=d[1],_=d[2],v=Vector.create([(c=(s=this.direction.elements)[1])*(h=(l=s[0])*(o[1]-g)-c*(o[0]-f))-(u=s[2])*(p=u*(o[0]-f)-l*((o[2]||0)-_)),u*(m=c*((o[2]||0)-_)-u*(o[1]-g))-l*h,l*p-c*m]),E=this.distanceFrom(o)/v.modulus();return Vector.create([o[0]+v.elements[0]*E,o[1]+v.elements[1]*E,(o[2]||0)+v.elements[2]*E])},rotate:function(e,t){void 0===t.direction&&(t=Line.create(t.to3D(),Vector.k));var n=Matrix.Rotation(e,t.direction).elements,r=t.pointClosestTo(this.anchor).elements,i=this.anchor.elements,a=this.direction.elements,o=r[0],s=r[1],l=r[2],c=i[0]-o,u=i[1]-s,h=i[2]-l;return Line.create([o+n[0][0]*c+n[0][1]*u+n[0][2]*h,s+n[1][0]*c+n[1][1]*u+n[1][2]*h,l+n[2][0]*c+n[2][1]*u+n[2][2]*h],[n[0][0]*a[0]+n[0][1]*a[1]+n[0][2]*a[2],n[1][0]*a[0]+n[1][1]*a[1]+n[1][2]*a[2],n[2][0]*a[0]+n[2][1]*a[1]+n[2][2]*a[2]])},reflectionIn:function(e){if(e.normal){var t=this.anchor.elements,n=this.direction.elements,r=t[0],i=t[1],a=t[2],o=n[0],s=n[1],l=n[2],c=this.anchor.reflectionIn(e).elements,u=r+o,h=i+s,m=a+l,p=e.pointClosestTo([u,h,m]).elements;return Line.create(c,[p[0]+(p[0]-u)-c[0],p[1]+(p[1]-h)-c[1],p[2]+(p[2]-m)-c[2]])}if(e.direction)return this.rotate(Math.PI,e);var d=e.elements||e;return Line.create(this.anchor.reflectionIn([d[0],d[1],d[2]||0]),this.direction)},setVectors:function(e,t){if(e=Vector.create(e),t=Vector.create(t),2==e.elements.length&&e.elements.push(0),2==t.elements.length&&t.elements.push(0),e.elements.length>3||t.elements.length>3)return null;var n=t.modulus();return 0===n?null:(this.anchor=e,this.direction=Vector.create([t.elements[0]/n,t.elements[1]/n,t.elements[2]/n]),this)}},Line.create=function(e,t){return(new Line).setVectors(e,t)},Line.X=Line.create(Vector.Zero(3),Vector.i),Line.Y=Line.create(Vector.Zero(3),Vector.j),Line.Z=Line.create(Vector.Zero(3),Vector.k),Plane.prototype={eql:function(e){return this.contains(e.anchor)&&this.isParallelTo(e)},dup:function(){return Plane.create(this.anchor,this.normal)},translate:function(e){var t=e.elements||e;return Plane.create([this.anchor.elements[0]+t[0],this.anchor.elements[1]+t[1],this.anchor.elements[2]+(t[2]||0)],this.normal)},isParallelTo:function(e){var t;return e.normal?(t=this.normal.angleFrom(e.normal),Math.abs(t)<=Sylvester.precision||Math.abs(Math.PI-t)<=Sylvester.precision):e.direction?this.normal.isPerpendicularTo(e.direction):null},isPerpendicularTo:function(e){var t=this.normal.angleFrom(e.normal);return Math.abs(Math.PI/2-t)<=Sylvester.precision},distanceFrom:function(e){if(this.intersects(e)||this.contains(e))return 0;if(e.anchor){var t=this.anchor.elements,n=e.anchor.elements,r=this.normal.elements;return Math.abs((t[0]-n[0])*r[0]+(t[1]-n[1])*r[1]+(t[2]-n[2])*r[2])}var i=e.elements||e;return t=this.anchor.elements,r=this.normal.elements,Math.abs((t[0]-i[0])*r[0]+(t[1]-i[1])*r[1]+(t[2]-(i[2]||0))*r[2])},contains:function(e){if(e.normal)return null;if(e.direction)return this.contains(e.anchor)&&this.contains(e.anchor.add(e.direction));var t=e.elements||e,n=this.anchor.elements,r=this.normal.elements;return Math.abs(r[0]*(n[0]-t[0])+r[1]*(n[1]-t[1])+r[2]*(n[2]-(t[2]||0)))<=Sylvester.precision},intersects:function(e){return void 0===e.direction&&void 0===e.normal?null:!this.isParallelTo(e)},intersectionWith:function(e){if(!this.intersects(e))return null;if(e.direction){var t=e.direction.elements,n=this.anchor.elements,r=((a=this.normal.elements)[0]*(n[0]-(o=e.anchor.elements)[0])+a[1]*(n[1]-o[1])+a[2]*(n[2]-o[2]))/(a[0]*t[0]+a[1]*t[1]+a[2]*t[2]);return Vector.create([o[0]+t[0]*r,o[1]+t[1]*r,o[2]+t[2]*r])}if(e.normal){for(var i=this.normal.cross(e.normal).toUnitVector(),a=this.normal.elements,o=this.anchor.elements,s=e.normal.elements,l=e.anchor.elements,c=Matrix.Zero(2,2),u=0;c.isSingular();)u++,c=Matrix.create([[a[u%3],a[(u+1)%3]],[s[u%3],s[(u+1)%3]]]);for(var h=c.inverse().elements,m=a[0]*o[0]+a[1]*o[1]+a[2]*o[2],p=s[0]*l[0]+s[1]*l[1]+s[2]*l[2],d=[h[0][0]*m+h[0][1]*p,h[1][0]*m+h[1][1]*p],f=[],g=1;g<=3;g++)f.push(u==g?0:d[(g+(5-u)%3)%3]);return Line.create(f,i)}},pointClosestTo:function(e){var t=e.elements||e,n=this.anchor.elements,r=this.normal.elements,i=(n[0]-t[0])*r[0]+(n[1]-t[1])*r[1]+(n[2]-(t[2]||0))*r[2];return Vector.create([t[0]+r[0]*i,t[1]+r[1]*i,(t[2]||0)+r[2]*i])},rotate:function(e,t){var n=Matrix.Rotation(e,t.direction).elements,r=t.pointClosestTo(this.anchor).elements,i=this.anchor.elements,a=this.normal.elements,o=r[0],s=r[1],l=r[2],c=i[0]-o,u=i[1]-s,h=i[2]-l;return Plane.create([o+n[0][0]*c+n[0][1]*u+n[0][2]*h,s+n[1][0]*c+n[1][1]*u+n[1][2]*h,l+n[2][0]*c+n[2][1]*u+n[2][2]*h],[n[0][0]*a[0]+n[0][1]*a[1]+n[0][2]*a[2],n[1][0]*a[0]+n[1][1]*a[1]+n[1][2]*a[2],n[2][0]*a[0]+n[2][1]*a[1]+n[2][2]*a[2]])},reflectionIn:function(e){if(e.normal){var t=this.anchor.elements,n=this.normal.elements,r=t[0],i=t[1],a=t[2],o=n[0],s=n[1],l=n[2],c=this.anchor.reflectionIn(e).elements,u=r+o,h=i+s,m=a+l,p=e.pointClosestTo([u,h,m]).elements;return Plane.create(c,[p[0]+(p[0]-u)-c[0],p[1]+(p[1]-h)-c[1],p[2]+(p[2]-m)-c[2]])}if(e.direction)return this.rotate(Math.PI,e);var d=e.elements||e;return Plane.create(this.anchor.reflectionIn([d[0],d[1],d[2]||0]),this.normal)},setVectors:function(e,t,n){if(null===(e=(e=Vector.create(e)).to3D()))return null;if(null===(t=(t=Vector.create(t)).to3D()))return null;if(void 0===n)n=null;else if(null===(n=(n=Vector.create(n)).to3D()))return null;var r,i,a=e.elements[0],o=e.elements[1],s=e.elements[2],l=t.elements[0],c=t.elements[1],u=t.elements[2];if(null!==n){var h=n.elements[0],m=n.elements[1],p=n.elements[2];if(0===(i=(r=Vector.create([(c-o)*(p-s)-(u-s)*(m-o),(u-s)*(h-a)-(l-a)*(p-s),(l-a)*(m-o)-(c-o)*(h-a)])).modulus()))return null;r=Vector.create([r.elements[0]/i,r.elements[1]/i,r.elements[2]/i])}else{if(0===(i=Math.sqrt(l*l+c*c+u*u)))return null;r=Vector.create([t.elements[0]/i,t.elements[1]/i,t.elements[2]/i])}return this.anchor=e,this.normal=r,this}},Plane.create=function(e,t,n){return(new Plane).setVectors(e,t,n)},Plane.XY=Plane.create(Vector.Zero(3),Vector.k),Plane.YZ=Plane.create(Vector.Zero(3),Vector.i),Plane.ZX=Plane.create(Vector.Zero(3),Vector.j),Plane.YX=Plane.XY,Plane.ZY=Plane.YZ,Plane.XZ=Plane.ZX;var $V=Vector.create,$M=Matrix.create,$L=Line.create,$P=Plane.create;function addWheelHandler(e,t){e.addEventListener?"onwheel"in document?e.addEventListener("wheel",t,!1):"onmousewheel"in document?e.addEventListener("mousewheel",t,!1):e.addEventListener("MozMousePixelScroll",t,!1):e.attachEvent("onmousewheel",t)}function clampMapPan(){var e=document.getElementById("map-canvas");map_pan[0]=clamp(map_pan[0],-(map_scale-1)*e.width,0),map_pan[1]=clamp(map_pan[1],-(map_scale-1)*e.height,0)}function mapOnWheel(e){var t=(e=e||window.event).wheelDelta?e.wheelDelta:-40*(e.deltaY||e.detail);t*=.8*map_scale;var n=null!=e.offsetX?e.offsetX:e.pageX-$("#map-canvas").offset().left,r=null!=e.offsetY?e.offsetY:e.pageY-$("#map-canvas").offset().top;map_scale_new=clamp(map_scale+.001*t,1,15),map_pan[0]=n-(n-map_pan[0])*map_scale_new/map_scale,map_pan[1]=r-(r-map_pan[1])*map_scale_new/map_scale,map_scale=map_scale_new,clampMapPan(),redraw_map(0),e.preventDefault?e.preventDefault():e.returnValue=!1}function on_touch_event(e){if(e.gesture){if("dragstart"==e.type)isDraggingMap=!0;else if("transformstart"==e.type)isTransformingMap=!0;else if("dragend"==e.type)isDraggingMap=!1;else if("transformend"==e.type)isTransformingMap=!1;else{if("drag"!=e.type&&"transform"!=e.type)return console.log("Unexpected event type"),void console.log(e);if("transform"==e.type){scale0=map_scale,map_scale=clamp(map_scale*e.gesture.scale/prevScale,1,3);var t=e.gesture.center.pageX-$("#map-canvas").offset().left,n=e.gesture.center.pageY-$("#map-canvas").offset().top;map_pan[0]=t-(t-map_pan[0])*map_scale/scale0,map_pan[1]=n-(n-map_pan[1])*map_scale/scale0}map_pan[0]+=e.gesture.center.pageX-prevMousePos[0],map_pan[1]+=e.gesture.center.pageY-prevMousePos[1],clampMapPan(),redraw_map(0)}prevMousePos=[e.gesture.center.pageX,e.gesture.center.pageY],prevScale=e.gesture.scale}}function calcMapObjectColor(e){if("blink"in e&&e.blink){var t=2==e.blink?blinkHeavyVal:blinkNormalVal,n=e["color[]"],r=[255,255,0];return rgb_to_hex(Math.floor(lerp(n[0],r[0],t)),Math.floor(lerp(n[1],r[1],t)),Math.floor(lerp(n[2],r[2],t)))}return e.color}function drawMapGrid(e){if(map_info&&"map_min"in map_info){var t=e.getContext("2d"),n=e.width,r=e.height,i=map_info.map_min,a=map_info.map_max,o=n/(a[0]-i[0]),s=r/(a[1]-i[1]);t.lineWidth=1,t.strokeStyle="#555",t.beginPath();for(var l=i[1];l<=a[1];l+=map_info.grid_steps[1]){var c=Math.floor((l-i[1])*s)+.5;t.moveTo(0,c),t.lineTo(n,c)}for(var u=i[0];u<=a[0];u+=map_info.grid_steps[0]){var h=Math.floor((u-i[0])*o)+.5;t.moveTo(h,0),t.lineTo(h,r)}t.stroke(),t.fillStyle="#111",t.font="normal 9pt sans-serif",t.textBaseline="middle",t.textAlign="left",l=i[1]+.5*map_info.grid_steps[1];for(var m=0;l<=a[1]&&m<26;l+=map_info.grid_steps[1],++m)c=Math.floor((l-i[1])*s)+.5,t.fillText(String.fromCharCode(65+m),3,c);for(t.textBaseline="top",t.textAlign="center",u=i[0]+.5*map_info.grid_steps[0],m=1;u<=a[0];u+=map_info.grid_steps[0],++m)h=Math.floor((u-i[0])*o)+.5,t.fillText(m,h,3)}}function drawMapGridScaled(e){if(map_info&&"map_min"in map_info){var t=e.getContext("2d"),n=e.width,r=e.height,i=map_info.map_min,a=map_info.map_max,o=map_info.grid_steps,s=n*map_scale/(a[0]-i[0]),l=r*map_scale/(a[1]-i[1]),c=Math.floor(-map_pan[0]/s/o[0]),u=Math.floor(-map_pan[1]/l/o[1]),h=i[0]+c*o[0],m=i[1]+u*o[1],p=i[0]+Math.ceil((n-map_pan[0])/s/o[0])*o[0],d=i[1]+Math.ceil((r-map_pan[1])/l/o[1])*o[1];t.lineWidth=1,t.strokeStyle="#555",t.beginPath();for(var f=m;f<=d;f+=o[1]){var g=Math.floor((f-i[1])*l+map_pan[1])+.5;t.moveTo(0,g),t.lineTo(n,g)}for(var _=h;_<=p;_+=o[0]){var v=Math.floor((_-i[0])*s+map_pan[0])+.5;t.moveTo(v,0),t.lineTo(v,r)}t.stroke(),t.fillStyle="#111",t.font="normal 9pt sans-serif",t.textBaseline="middle",t.textAlign="left",f=m+.5*map_info.grid_steps[1];for(var E=u;f<=d&&E<26;f+=o[1],++E)g=Math.floor((f-i[1])*l+map_pan[1])+.5,t.fillText(String.fromCharCode(65+E),3,g);for(t.textBaseline="top",t.textAlign="center",_=h+.5*map_info.grid_steps[0],E=c;_<=p;_+=o[0],++E)v=Math.floor((_-i[0])*s+map_pan[0])+.5,t.fillText(E+1,v,3)}}function draw_airfield(e,t,n){var r=e.width*n.sx*map_scale+map_pan[0],i=e.height*n.sy*map_scale+map_pan[1],a=e.width*n.ex*map_scale+map_pan[0],o=e.height*n.ey*map_scale+map_pan[1];t.lineWidth=3*Math.sqrt(map_scale),t.strokeStyle=calcMapObjectColor(n),t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),t.stroke()}function draw_player(e,t,n,r){var i=n.x,a=n.y,o=$V([n.dx,n.dy]);if(lastPlayerPos){var s=lastPlayerPos.x,l=lastPlayerPos.y;Math.abs(s-i)<.01&&(i=approach(s,i,r,.4)),Math.abs(l-a)<.01&&(a=approach(l,a,r,.4));var c=$V(lastPlayerPos.dir),u=o.signedAngle2DFrom(c);u>.25*-Math.PI&&u<.25*Math.PI&&(u=approach(0,u,r,.4),o=c.rotate(u,[0,0]))}t.fillStyle="#fff",t.lineWidth=2,t.strokeStyle="#333",t.beginPath();var h=o.at(0),m=o.at(1),p=i*e.width*map_scale+map_pan[0],d=a*e.height*map_scale+map_pan[1];return t.moveTo((p-=5*h)-4*m,(d-=5*m)+4*h),t.lineTo(p+4*m,d-4*h),t.lineTo(p+10*h,d+10*m),t.closePath(),t.fill(),t.stroke(),{x:i,y:a,dir:o.elements}}function draw_map_object(e,t,n,r){var i=e.width*n.x,a=e.height*n.y;t.fillStyle=calcMapObjectColor(n),t.lineWidth=1,t.strokeStyle="#000",t.font="bold 18pt Icons",t.textBaseline="middle",t.textAlign="center";var o,s=i*map_scale+map_pan[0],l=a*map_scale+map_pan[1];if(o="Airdefence"==n.icon?"4":"Structure"==n.icon?"5":"waypoint"==n.icon?"6":"capture_zone"==n.icon?"7":"bombing_point"==n.icon?"8":"defending_point"==n.icon?"9":"respawn_base_tank"==n.icon?"0":"respawn_base_fighter"==n.icon?".":"respawn_base_bomber"==n.icon?":":n.icon[0],r){t.save(),t.translate(s,l);var c=Math.atan2(n.dx,-n.dy);t.rotate(c),t.translate(-s,-l),t.fillText(o,s,l),t.strokeText(o,s,l),t.restore()}else t.fillText(o,s,l),t.strokeText(o,s,l)}function redraw_map(e){var t=document.getElementById("map-canvas"),n=t.getContext("2d");n.clearRect(0,0,t.width,t.height),n.setTransform(map_scale,0,0,map_scale,map_pan[0],map_pan[1]),map_image.complete&&map_image.naturalWidth&&n.drawImage(map_image,0,0,t.width,t.height),n.setTransform(1,0,0,1,0,0),drawMapGridScaled(t);var r=null;if($.isArray(map_objects))for(var i=0;i<map_objects.length;++i){var a=map_objects[i];"airfield"==a.type?draw_airfield(t,n,a):"Player"==a.icon?r=a:draw_map_object(t,n,a,"respawn_base_fighter"==a.type||"respawn_base_bomber"==a.type)}lastPlayerPos=r?draw_player(t,n,r,e):null}function update_timers(){var e=(new Date).getTime(),t=0;return lastT&&(t=.001*(e-lastT),blinkNormalT+=t,blinkHeavyT+=t,blinkNormalT>2&&(blinkNormalT-=2*Math.floor(blinkNormalT/2)),blinkHeavyT>1.2&&(blinkHeavyT-=1.2*Math.floor(blinkHeavyT/1.2)),blinkNormalVal=Math.exp(-Math.pow(5*blinkNormalT-2,4)),blinkHeavyVal=Math.exp(-Math.pow(5*blinkHeavyT-2,4))),lastT=e,t}function update_object_positions(e){map_objects=e,redraw_map(update_timers())}function update_map_info(e){var t=map_info&&"map_generation"in map_info?map_info.map_generation:-1,n=e&&"map_generation"in e?e.map_generation:-1;if(map_info=e,t!=n){const e=localStorage.getItem("endpoint")||"http://localhost:8111";map_image.src=e+"/map.img?gen="+n,map_scale=1,map_pan=[0,0],redraw_map(0)}}function updateSlow(){const e=localStorage.getItem("endpoint")||"http://localhost:8111";$.ajax({type:"GET",url:e+"/map_obj.json",success:update_object_positions}),$.ajax({type:"GET",url:e+"/map_info.json",success:update_map_info})}function updateFast(){var e=update_timers();isDraggingMap||isTransformingMap||redraw_map(e)}function normalizeText(e){return e.replace("<","&lt;").replace(">","&gt;")}function localize_static(){for(var e=$(".loc"),t=e.length,n=0;n<t;++n){var r=$(e[n]),i=r.text();i in loc_tbl&&r.text(loc_tbl[i])}}function lerp(e,t,n){return e*(1-n)+t*n}function clamp(e,t,n){return Math.max(t,Math.min(e,n))}function approach(e,t,n,r){return r<1e-9?t:e+(1-Math.exp(-n/r))*(t-e)}function rgb_to_hex(e,t,n){var r=e.toString(16),i=t.toString(16),a=n.toString(16);return"#"+(1==r.length?"0"+r:r)+(1==i.length?"0"+i:i)+(1==a.length?"0"+a:a)}function get_pos_prop(e,t){return"width"==t||"height"==t?e[t]():e.offset()[t]}function set_pos_prop(e,t,n){if("width"==t||"height"==t)return e[t](n);var r=e.offset();r[t]=n,e.offset(r)}function load_positions(){for(var e in pos_save_elem_ids){var t=Cookies.get(e);if(t){var n=$(e),r=t.split("|");for(var i in r){var a=r[i].split(":");2==a.length&&set_pos_prop(n,a[0],a[1])}}}var o=$("#map-canvas");o.get(0).width=o.width(),o.get(0).height=o.height()}function save_positions(){for(var e in pos_save_elem_ids){var t=$(e),n=pos_save_elem_ids[e],r="";for(var i in n)r&&(r+="|"),r+=n[i]+":"+get_pos_prop(t,n[i]);r&&Cookies.set(e,r,{expires:cookieLifeTime})}}function init(){localize_static();var e=document.getElementById("map-canvas");addWheelHandler(e,mapOnWheel),e.onselectstart=function(){return!1};var t=Hammer(e,hammer_opt),n=["drag","dragstart","dragend","transform","transformstart","transformend"];for(var r in n)t.on(n[r],on_touch_event);load_positions(),$("#map-root").draggable({handle:"#draghandle",stop:save_positions}),"file:"!=document.location.protocol&&(setInterval(updateSlow,500),setInterval(updateFast,25))}map_objects=null,map_info=null,map_image=new Image,cookieLifeTime=864e5,map_scale=1,map_pan=[0,0],prevMousePos=null,prevScale=null,lastT=null,blinkNormalT=0,blinkHeavyT=0,blinkNormalVal=0,blinkHeavyVal=0,lastPlayerPos=null,isDraggingMap=!1,isTransformingMap=!1,hammer_opt={hold:!1,tap:!1,doubletap:!1,drag:!0,dragstart:!0,dragend:!0,dragup:!1,dragdown:!1,dragleft:!1,dragright:!1,swipe:!1,swipeup:!1,swipedown:!1,swipeleft:!1,swiperight:!1,transform:!0,transformstart:!0,transformend:!0,rotate:!1,pinch:!1,pinchin:!1,pinchout:!1,prevent_default:!0,no_mouseevents:!0},Array.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1}),pos_save_elem_ids={"#map-root":["left","top"],"#map-canvas":["width","height"]},window.onload=init,function(e,t){"use strict";var n=function(e,t){return new n.Instance(e,t||{})};n.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},n.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled,n.HAS_TOUCHEVENTS="ontouchstart"in e,n.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i,n.NO_MOUSEEVENTS=n.HAS_TOUCHEVENTS&&navigator.userAgent.match(n.MOBILE_REGEX),n.EVENT_TYPES={},n.DIRECTION_DOWN="down",n.DIRECTION_LEFT="left",n.DIRECTION_UP="up",n.DIRECTION_RIGHT="right",n.POINTER_MOUSE="mouse",n.POINTER_TOUCH="touch",n.POINTER_PEN="pen",n.EVENT_START="start",n.EVENT_MOVE="move",n.EVENT_END="end",n.DOCUMENT=document,n.plugins={},n.READY=!1,n.Instance=function(e,t){var r=this;return function(){if(!n.READY){for(var e in n.event.determineEventTypes(),n.gestures)n.gestures.hasOwnProperty(e)&&n.detection.register(n.gestures[e]);n.event.onTouch(n.DOCUMENT,n.EVENT_MOVE,n.detection.detect),n.event.onTouch(n.DOCUMENT,n.EVENT_END,n.detection.detect),n.READY=!0}}(),this.element=e,this.enabled=!0,this.options=n.utils.extend(n.utils.extend({},n.defaults),t||{}),this.options.stop_browser_behavior&&n.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),n.event.onTouch(e,n.EVENT_START,function(e){r.enabled&&n.detection.startDetect(r,e)}),this},n.Instance.prototype={on:function(e,t){for(var n=e.split(" "),r=0;n.length>r;r++)this.element.addEventListener(n[r],t,!1);return this},off:function(e,t){for(var n=e.split(" "),r=0;n.length>r;r++)this.element.removeEventListener(n[r],t,!1);return this},trigger:function(e,t){var r=n.DOCUMENT.createEvent("Event");r.initEvent(e,!0,!0),r.gesture=t;var i=this.element;return n.utils.hasParent(t.target,i)&&(i=t.target),i.dispatchEvent(r),this},enable:function(e){return this.enabled=e,this}};var r=null,i=!1,a=!1;n.event={bindDom:function(e,t,n){for(var r=t.split(" "),i=0;r.length>i;i++)e.addEventListener(r[i],n,!1)},onTouch:function(e,t,o){var s=this;this.bindDom(e,n.EVENT_TYPES[t],function(l){var c=l.type.toLowerCase();if(!c.match(/mouse/)||!a){(c.match(/touch/)||c.match(/pointerdown/)||c.match(/mouse/)&&1===l.which)&&(i=!0),c.match(/touch|pointer/)&&(a=!0);var u=0;i&&(n.HAS_POINTEREVENTS&&t!=n.EVENT_END?u=n.PointerEvent.updatePointer(t,l):c.match(/touch/)?u=l.touches.length:a||(u=c.match(/up/)?0:1),u>0&&t==n.EVENT_END?t=n.EVENT_MOVE:u||(t=n.EVENT_END),u||null===r?r=l:l=r,o.call(n.detection,s.collectEventData(e,t,l)),n.HAS_POINTEREVENTS&&t==n.EVENT_END&&(u=n.PointerEvent.updatePointer(t,l))),u||(r=null,i=!1,a=!1,n.PointerEvent.reset())}})},determineEventTypes:function(){var e;e=n.HAS_POINTEREVENTS?n.PointerEvent.getEvents():n.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],n.EVENT_TYPES[n.EVENT_START]=e[0],n.EVENT_TYPES[n.EVENT_MOVE]=e[1],n.EVENT_TYPES[n.EVENT_END]=e[2]},getTouchList:function(e){return n.HAS_POINTEREVENTS?n.PointerEvent.getTouchList():e.touches?e.touches:[{identifier:1,pageX:e.pageX,pageY:e.pageY,target:e.target}]},collectEventData:function(e,t,r){var i=this.getTouchList(r,t),a=n.POINTER_TOUCH;return(r.type.match(/mouse/)||n.PointerEvent.matchType(n.POINTER_MOUSE,r))&&(a=n.POINTER_MOUSE),{center:n.utils.getCenter(i),timeStamp:(new Date).getTime(),target:r.target,touches:i,eventType:t,pointerType:a,srcEvent:r,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return n.detection.stopDetect()}}}},n.PointerEvent={pointers:{},getTouchList:function(){var e=this,t=[];return Object.keys(e.pointers).sort().forEach(function(n){t.push(e.pointers[n])}),t},updatePointer:function(e,t){return e==n.EVENT_END?this.pointers={}:(t.identifier=t.pointerId,this.pointers[t.pointerId]=t),Object.keys(this.pointers).length},matchType:function(e,t){if(!t.pointerType)return!1;var r={};return r[n.POINTER_MOUSE]=t.pointerType==t.MSPOINTER_TYPE_MOUSE||t.pointerType==n.POINTER_MOUSE,r[n.POINTER_TOUCH]=t.pointerType==t.MSPOINTER_TYPE_TOUCH||t.pointerType==n.POINTER_TOUCH,r[n.POINTER_PEN]=t.pointerType==t.MSPOINTER_TYPE_PEN||t.pointerType==n.POINTER_PEN,r[e]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},n.utils={extend:function(e,n,r){for(var i in n)e[i]!==t&&r||(e[i]=n[i]);return e},hasParent:function(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1},getCenter:function(e){for(var t=[],n=[],r=0,i=e.length;i>r;r++)t.push(e[r].pageX),n.push(e[r].pageY);return{pageX:(Math.min.apply(Math,t)+Math.max.apply(Math,t))/2,pageY:(Math.min.apply(Math,n)+Math.max.apply(Math,n))/2}},getVelocity:function(e,t,n){return{x:Math.abs(t/e)||0,y:Math.abs(n/e)||0}},getAngle:function(e,t){return 180*Math.atan2(t.pageY-e.pageY,t.pageX-e.pageX)/Math.PI},getDirection:function(e,t){return Math.abs(e.pageX-t.pageX)>=Math.abs(e.pageY-t.pageY)?e.pageX-t.pageX>0?n.DIRECTION_LEFT:n.DIRECTION_RIGHT:e.pageY-t.pageY>0?n.DIRECTION_UP:n.DIRECTION_DOWN},getDistance:function(e,t){var n=t.pageX-e.pageX,r=t.pageY-e.pageY;return Math.sqrt(n*n+r*r)},getScale:function(e,t){return e.length>=2&&t.length>=2?this.getDistance(t[0],t[1])/this.getDistance(e[0],e[1]):1},getRotation:function(e,t){return e.length>=2&&t.length>=2?this.getAngle(t[1],t[0])-this.getAngle(e[1],e[0]):0},isVertical:function(e){return e==n.DIRECTION_UP||e==n.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(e,t){var n,r=["webkit","khtml","moz","ms","o",""];if(t&&e.style){for(var i=0;r.length>i;i++)for(var a in t)t.hasOwnProperty(a)&&(n=a,r[i]&&(n=r[i]+n.substring(0,1).toUpperCase()+n.substring(1)),e.style[n]=t[a]);"none"==t.userSelect&&(e.onselectstart=function(){return!1})}}},n.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(e,t){this.current||(this.stopped=!1,this.current={inst:e,startEvent:n.utils.extend({},t),lastEvent:!1,name:""},this.detect(t))},detect:function(e){if(this.current&&!this.stopped){e=this.extendEventData(e);for(var t=this.current.inst.options,r=0,i=this.gestures.length;i>r;r++){var a=this.gestures[r];if(!this.stopped&&!1!==t[a.name]&&!1===a.handler.call(a,e,this.current.inst)){this.stopDetect();break}}return this.current&&(this.current.lastEvent=e),e.eventType==n.EVENT_END&&!e.touches.length-1&&this.stopDetect(),e}},stopDetect:function(){this.previous=n.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(e){var t=this.current.startEvent;if(t&&(e.touches.length!=t.touches.length||e.touches===t.touches)){t.touches=[];for(var r=0,i=e.touches.length;i>r;r++)t.touches.push(n.utils.extend({},e.touches[r]))}var a=e.timeStamp-t.timeStamp,o=e.center.pageX-t.center.pageX,s=e.center.pageY-t.center.pageY,l=n.utils.getVelocity(a,o,s);return n.utils.extend(e,{deltaTime:a,deltaX:o,deltaY:s,velocityX:l.x,velocityY:l.y,distance:n.utils.getDistance(t.center,e.center),angle:n.utils.getAngle(t.center,e.center),direction:n.utils.getDirection(t.center,e.center),scale:n.utils.getScale(t.touches,e.touches),rotation:n.utils.getRotation(t.touches,e.touches),startEvent:t}),e},register:function(e){var r=e.defaults||{};return r[e.name]===t&&(r[e.name]=!0),n.utils.extend(n.defaults,r,!0),e.index=e.index||1e3,this.gestures.push(e),this.gestures.sort(function(e,t){return e.index<t.index?-1:e.index>t.index?1:0}),this.gestures}},n.gestures=n.gestures||{},n.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(e,t){switch(e.eventType){case n.EVENT_START:clearTimeout(this.timer),n.detection.current.name=this.name,this.timer=setTimeout(function(){"hold"==n.detection.current.name&&t.trigger("hold",e)},t.options.hold_timeout);break;case n.EVENT_MOVE:e.distance>t.options.hold_threshold&&clearTimeout(this.timer);break;case n.EVENT_END:clearTimeout(this.timer)}}},n.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(e,t){if(e.eventType==n.EVENT_END){var r=n.detection.previous,i=!1;if(e.deltaTime>t.options.tap_max_touchtime||e.distance>t.options.tap_max_distance)return;r&&"tap"==r.name&&e.timeStamp-r.lastEvent.timeStamp<t.options.doubletap_interval&&e.distance<t.options.doubletap_distance&&(t.trigger("doubletap",e),i=!0),(!i||t.options.tap_always)&&(n.detection.current.name="tap",t.trigger(n.detection.current.name,e))}}},n.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_max_touches:1,swipe_velocity:.7},handler:function(e,t){if(e.eventType==n.EVENT_END){if(t.options.swipe_max_touches>0&&e.touches.length>t.options.swipe_max_touches)return;(e.velocityX>t.options.swipe_velocity||e.velocityY>t.options.swipe_velocity)&&(t.trigger(this.name,e),t.trigger(this.name+e.direction,e))}}},n.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(e,r){if(n.detection.current.name!=this.name&&this.triggered)return r.trigger(this.name+"end",e),this.triggered=!1,t;if(!(r.options.drag_max_touches>0&&e.touches.length>r.options.drag_max_touches))switch(e.eventType){case n.EVENT_START:this.triggered=!1;break;case n.EVENT_MOVE:if(e.distance<r.options.drag_min_distance&&n.detection.current.name!=this.name)return;n.detection.current.name=this.name,(n.detection.current.lastEvent.drag_locked_to_axis||r.options.drag_lock_to_axis&&r.options.drag_lock_min_distance<=e.distance)&&(e.drag_locked_to_axis=!0);var i=n.detection.current.lastEvent.direction;e.drag_locked_to_axis&&i!==e.direction&&(e.direction=n.utils.isVertical(i)?0>e.deltaY?n.DIRECTION_UP:n.DIRECTION_DOWN:0>e.deltaX?n.DIRECTION_LEFT:n.DIRECTION_RIGHT),this.triggered||(r.trigger(this.name+"start",e),this.triggered=!0),r.trigger(this.name,e),r.trigger(this.name+e.direction,e),(r.options.drag_block_vertical&&n.utils.isVertical(e.direction)||r.options.drag_block_horizontal&&!n.utils.isVertical(e.direction))&&e.preventDefault();break;case n.EVENT_END:this.triggered&&r.trigger(this.name+"end",e),this.triggered=!1}}},n.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(e,r){if(n.detection.current.name!=this.name&&this.triggered)return r.trigger(this.name+"end",e),this.triggered=!1,t;if(!(2>e.touches.length))switch(r.options.transform_always_block&&e.preventDefault(),e.eventType){case n.EVENT_START:this.triggered=!1;break;case n.EVENT_MOVE:var i=Math.abs(1-e.scale),a=Math.abs(e.rotation);if(r.options.transform_min_scale>i&&r.options.transform_min_rotation>a)return;n.detection.current.name=this.name,this.triggered||(r.trigger(this.name+"start",e),this.triggered=!0),r.trigger(this.name,e),a>r.options.transform_min_rotation&&r.trigger("rotate",e),i>r.options.transform_min_scale&&(r.trigger("pinch",e),r.trigger("pinch"+(1>e.scale?"in":"out"),e));break;case n.EVENT_END:this.triggered&&r.trigger(this.name+"end",e),this.triggered=!1}}},n.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(e,r){return r.options.prevent_mouseevents&&e.pointerType==n.POINTER_MOUSE?(e.stopDetect(),t):(r.options.prevent_default&&e.preventDefault(),e.eventType==n.EVENT_START&&r.trigger(this.name,e),t)}},n.gestures.Release={name:"release",index:1/0,handler:function(e,t){e.eventType==n.EVENT_END&&t.trigger(this.name,e)}},"object"==typeof module&&"object"==typeof module.exports?module.exports=n:(e.Hammer=n,"function"==typeof e.define&&e.define.amd&&e.define("hammer",[],function(){return n}))}(this),$(document).ready(function(){var e=!0,t=$("#playerName"),n=$("#endpoint"),r=$("#squadMembers"),i=$("#squadMembersEndpoint"),a=$([]).add(t).add(n).add(r).add(i);function o(e,t,n,r){return!(e.val().length>r||e.val().length<n)||(e.addClass("ui-state-error"),updateTips("Length of "+t+" must be between "+n+" and "+r+"."),!1)}null!==localStorage.getItem("playerName")&&t.val(localStorage.getItem("playerName")),null!==localStorage.getItem("endpoint")&&n.val(localStorage.getItem("endpoint")),null!==localStorage.getItem("squadMembers")&&r.val(localStorage.getItem("squadMembers")),null!==localStorage.getItem("squadMembersEndpoint")&&i.val(localStorage.getItem("squadMembersEndpoint")),null!==localStorage.getItem("playerName")&&null!==localStorage.getItem("endpoint")&&(e=!1),$("#settingsSave").on("click",function(e){var s;e.preventDefault(),s=!0,a.removeClass("ui-state-error"),(s=(s=s&&o(t,"playerName",1,100))&&o(n,"endpoint",6,100))&&(localStorage.setItem("playerName",t.val()),localStorage.setItem("endpoint",n.val()),localStorage.setItem("squadMembers",r.val()),localStorage.setItem("squadMembersEndpoint",i.val()),null!==localStorage.getItem("playerName")&&t.val(localStorage.getItem("playerName")),null!==localStorage.getItem("endpoint")&&n.val(localStorage.getItem("endpoint")),null!==localStorage.getItem("squadMembers")&&r.val(localStorage.getItem("squadMembers")),null!==localStorage.getItem("squadMembersEndpoint")&&i.val(localStorage.getItem("squadMembersEndpoint"))),s?$("#settingsModal").modal("hide"):console.log("Invalid Settings")}),e&&$("#settingsModal").modal()});