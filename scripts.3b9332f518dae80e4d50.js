!function(e){"use strict";var t=function(e,n,r){return 1===arguments.length?t.get(e):t.set(e,n,r)};t._document=document,t._navigator=navigator,t.defaults={path:"/"},t.get=function(e){return t._cachedDocumentCookie!==t._document.cookie&&t._renewCache(),t._cache[e]},t.set=function(n,r,i){return(i=t._getExtendedOptions(i)).expires=t._getExpiresDate(r===e?-1:i.expires),t._document.cookie=t._generateCookieString(n,r,i),t},t.expire=function(n,r){return t.set(n,e,r)},t._getExtendedOptions=function(n){return{path:n&&n.path||t.defaults.path,domain:n&&n.domain||t.defaults.domain,expires:n&&n.expires||t.defaults.expires,secure:n&&n.secure!==e?n.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){switch(n=n||new Date,typeof e){case"number":e=new Date(n.getTime()+1e3*e);break;case"string":e=new Date(e)}if(e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){var r=(e=encodeURIComponent(e))+"="+(t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent));return r+=(n=n||{}).path?";path="+n.path:"",r+=n.domain?";domain="+n.domain:"",(r+=n.expires?";expires="+n.expires.toGMTString():"")+(n.secure?";secure":"")},t._getCookieObjectFromString=function(n){for(var r={},i=n?n.split("; "):[],s=0;s<i.length;s++){var l=t._getKeyValuePairFromCookieString(i[s]);r[l.key]===e&&(r[l.key]=l.value)}return r},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");return t=t<0?e.length:t,{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}},t._renewCache=function(){t._cache=t._getCookieObjectFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){return t._navigator.cookieEnabled||"1"===t.set("cookies.js",1).get("cookies.js")},t.enabled=t._areEnabled(),"function"==typeof define&&define.amd?define(function(){return t}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.Cookies=t):window.Cookies=t}();var Sylvester={version:"0.1.3",precision:1e-6};function Vector(){}function Matrix(){}function Line(){}function Plane(){}Vector.prototype={e:function(e){return e<1||e>this.elements.length?null:this.elements[e-1]},at:function(e){return e<0||e>=this.elements.length?null:this.elements[e]},dimensions:function(){return this.elements.length},modulus:function(){return Math.sqrt(this.dot(this))},eql:function(e){var t=this.elements.length,n=e.elements||e;if(t!=n.length)return!1;do{if(Math.abs(this.elements[t-1]-n[t-1])>Sylvester.precision)return!1}while(--t);return!0},dup:function(){return Vector.create(this.elements)},map:function(e){var t=[];return this.each(function(n,r){t.push(e(n,r))}),Vector.create(t)},each:function(e){var t,n=this.elements.length,r=n;do{e(this.elements[t=r-n],t+1)}while(--n)},toUnitVector:function(){var e=this.modulus();return 0===e?this.dup():this.map(function(t){return t/e})},angleFrom:function(e){var t=e.elements||e;if(this.elements.length!=t.length)return null;var n=0,r=0,i=0;if(this.each(function(e,s){n+=e*t[s-1],r+=e*e,i+=t[s-1]*t[s-1]}),r=Math.sqrt(r),i=Math.sqrt(i),r*i==0)return null;var s=n/(r*i);return s<-1&&(s=-1),s>1&&(s=1),Math.acos(s)},signedAngle2DFrom:function(e){var t=this.elements,n=e.elements||e;return 2!=n.length||2!=t.length?null:Math.atan2(n[0]*t[1]-n[1]*t[0],n[0]*t[0]+n[1]*t[1])},isParallelTo:function(e){var t=this.angleFrom(e);return null===t?null:t<=Sylvester.precision},isAntiparallelTo:function(e){var t=this.angleFrom(e);return null===t?null:Math.abs(t-Math.PI)<=Sylvester.precision},isPerpendicularTo:function(e){var t=this.dot(e);return null===t?null:Math.abs(t)<=Sylvester.precision},add:function(e){var t=e.elements||e;return this.elements.length!=t.length?null:this.map(function(e,n){return e+t[n-1]})},subtract:function(e){var t=e.elements||e;return this.elements.length!=t.length?null:this.map(function(e,n){return e-t[n-1]})},multiply:function(e){return this.map(function(t){return t*e})},x:function(e){return this.multiply(e)},dot:function(e){var t=e.elements||e,n=0,r=this.elements.length;if(r!=t.length)return null;do{n+=this.elements[r-1]*t[r-1]}while(--r);return n},cross:function(e){var t=e.elements||e;if(3!=this.elements.length||3!=t.length)return null;var n=this.elements;return Vector.create([n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]])},max:function(){var e,t=0,n=this.elements.length,r=n;do{e=r-n,Math.abs(this.elements[e])>Math.abs(t)&&(t=this.elements[e])}while(--n);return t},indexOf:function(e){var t,n=null,r=this.elements.length,i=r;do{t=i-r,null===n&&this.elements[t]==e&&(n=t+1)}while(--r);return n},toDiagonalMatrix:function(){return Matrix.Diagonal(this.elements)},round:function(){return this.map(function(e){return Math.round(e)})},snapTo:function(e){return this.map(function(t){return Math.abs(t-e)<=Sylvester.precision?e:t})},distanceFrom:function(e){if(e.anchor)return e.distanceFrom(this);var t=e.elements||e;if(t.length!=this.elements.length)return null;var n,r=0;return this.each(function(e,i){r+=(n=e-t[i-1])*n}),Math.sqrt(r)},liesOn:function(e){return e.contains(this)},liesIn:function(e){return e.contains(this)},rotate:function(e,t){var n,r,i,s,l;switch(this.elements.length){case 2:return 2!=(n=t.elements||t).length?null:(r=Matrix.Rotation(e).elements,Vector.create([n[0]+r[0][0]*(i=this.elements[0]-n[0])+r[0][1]*(s=this.elements[1]-n[1]),n[1]+r[1][0]*i+r[1][1]*s]));case 3:if(!t.direction)return null;var o=t.pointClosestTo(this).elements;return r=Matrix.Rotation(e,t.direction).elements,Vector.create([o[0]+r[0][0]*(i=this.elements[0]-o[0])+r[0][1]*(s=this.elements[1]-o[1])+r[0][2]*(l=this.elements[2]-o[2]),o[1]+r[1][0]*i+r[1][1]*s+r[1][2]*l,o[2]+r[2][0]*i+r[2][1]*s+r[2][2]*l]);default:return null}},reflectionIn:function(e){if(e.anchor){var t=this.elements.slice(),n=e.pointClosestTo(t).elements;return Vector.create([n[0]+(n[0]-t[0]),n[1]+(n[1]-t[1]),n[2]+(n[2]-(t[2]||0))])}var r=e.elements||e;return this.elements.length!=r.length?null:this.map(function(e,t){return r[t-1]+(r[t-1]-e)})},to3D:function(){var e=this.dup();switch(e.elements.length){case 3:break;case 2:e.elements.push(0);break;default:return null}return e},inspect:function(){return"["+this.elements.join(", ")+"]"},setElements:function(e){return this.elements=(e.elements||e).slice(),this}},Vector.create=function(e){return(new Vector).setElements(e)},Vector.i=Vector.create([1,0,0]),Vector.j=Vector.create([0,1,0]),Vector.k=Vector.create([0,0,1]),Vector.Random=function(e){var t=[];do{t.push(Math.random())}while(--e);return Vector.create(t)},Vector.Zero=function(e){var t=[];do{t.push(0)}while(--e);return Vector.create(t)},Matrix.prototype={e:function(e,t){return e<1||e>this.elements.length||t<1||t>this.elements[0].length?null:this.elements[e-1][t-1]},row:function(e){return e>this.elements.length?null:Vector.create(this.elements[e-1])},col:function(e){if(e>this.elements[0].length)return null;var t=[],n=this.elements.length,r=n;do{t.push(this.elements[r-n][e-1])}while(--n);return Vector.create(t)},dimensions:function(){return{rows:this.elements.length,cols:this.elements[0].length}},rows:function(){return this.elements.length},cols:function(){return this.elements[0].length},eql:function(e){var t=e.elements||e;if(void 0===t[0][0]&&(t=Matrix.create(t).elements),this.elements.length!=t.length||this.elements[0].length!=t[0].length)return!1;var n,r,i,s=this.elements.length,l=s,o=this.elements[0].length;do{n=l-s,r=o;do{if(i=o-r,Math.abs(this.elements[n][i]-t[n][i])>Sylvester.precision)return!1}while(--r)}while(--s);return!0},dup:function(){return Matrix.create(this.elements)},map:function(e){var t,n,r,i=[],s=this.elements.length,l=s,o=this.elements[0].length;do{n=o,i[t=l-s]=[];do{i[t][r=o-n]=e(this.elements[t][r],t+1,r+1)}while(--n)}while(--s);return Matrix.create(i)},isSameSizeAs:function(e){var t=e.elements||e;return void 0===t[0][0]&&(t=Matrix.create(t).elements),this.elements.length==t.length&&this.elements[0].length==t[0].length},add:function(e){var t=e.elements||e;return void 0===t[0][0]&&(t=Matrix.create(t).elements),this.isSameSizeAs(t)?this.map(function(e,n,r){return e+t[n-1][r-1]}):null},subtract:function(e){var t=e.elements||e;return void 0===t[0][0]&&(t=Matrix.create(t).elements),this.isSameSizeAs(t)?this.map(function(e,n,r){return e-t[n-1][r-1]}):null},canMultiplyFromLeft:function(e){var t=e.elements||e;return void 0===t[0][0]&&(t=Matrix.create(t).elements),this.elements[0].length==t.length},multiply:function(e){if(!e.elements)return this.map(function(t){return t*e});var t=!!e.modulus;if(void 0===(f=e.elements||e)[0][0]&&(f=Matrix.create(f).elements),!this.canMultiplyFromLeft(f))return null;var n,r,i,s,l,o,a=this.elements.length,h=a,c=f[0].length,u=this.elements[0].length,m=[];do{m[n=h-a]=[],r=c;do{i=c-r,s=0,l=u;do{s+=this.elements[n][o=u-l]*f[o][i]}while(--l);m[n][i]=s}while(--r)}while(--a);var f=Matrix.create(m);return t?f.col(1):f},x:function(e){return this.multiply(e)},minor:function(e,t,n,r){var i,s,l,o=[],a=n,h=this.elements.length,c=this.elements[0].length;do{o[i=n-a]=[],s=r;do{o[i][l=r-s]=this.elements[(e+i-1)%h][(t+l-1)%c]}while(--s)}while(--a);return Matrix.create(o)},transpose:function(){var e,t,n,r=this.elements.length,i=this.elements[0].length,s=[],l=i;do{s[e=i-l]=[],t=r;do{s[e][n=r-t]=this.elements[n][e]}while(--t)}while(--l);return Matrix.create(s)},isSquare:function(){return this.elements.length==this.elements[0].length},max:function(){var e,t,n,r=0,i=this.elements.length,s=i,l=this.elements[0].length;do{e=s-i,t=l;do{n=l-t,Math.abs(this.elements[e][n])>Math.abs(r)&&(r=this.elements[e][n])}while(--t)}while(--i);return r},indexOf:function(e){var t,n,r,i=this.elements.length,s=i,l=this.elements[0].length;do{t=s-i,n=l;do{if(this.elements[t][r=l-n]==e)return{i:t+1,j:r+1}}while(--n)}while(--i);return null},diagonal:function(){if(!this.isSquare)return null;var e,t=[],n=this.elements.length,r=n;do{t.push(this.elements[e=r-n][e])}while(--n);return Vector.create(t)},toRightTriangular:function(){var e,t,n,r,i=this.dup(),s=this.elements.length,l=s,o=this.elements[0].length;do{if(0==i.elements[t=l-s][t])for(j=t+1;j<l;j++)if(0!=i.elements[j][t]){e=[],n=o;do{e.push(i.elements[t][r=o-n]+i.elements[j][r])}while(--n);i.elements[t]=e;break}if(0!=i.elements[t][t])for(j=t+1;j<l;j++){var a=i.elements[j][t]/i.elements[t][t];e=[],n=o;do{e.push((r=o-n)<=t?0:i.elements[j][r]-i.elements[t][r]*a)}while(--n);i.elements[j]=e}}while(--s);return i},toUpperTriangular:function(){return this.toRightTriangular()},determinant:function(){if(!this.isSquare())return null;var e,t=this.toRightTriangular(),n=t.elements[0][0],r=t.elements.length-1,i=r;do{n*=t.elements[e=i-r+1][e]}while(--r);return n},det:function(){return this.determinant()},isSingular:function(){return this.isSquare()&&0===this.determinant()},trace:function(){if(!this.isSquare())return null;var e,t=this.elements[0][0],n=this.elements.length-1,r=n;do{t+=this.elements[e=r-n+1][e]}while(--n);return t},tr:function(){return this.trace()},rank:function(){var e,t,n=this.toRightTriangular(),r=0,i=this.elements.length,s=i,l=this.elements[0].length;do{e=s-i,t=l;do{if(Math.abs(n.elements[e][l-t])>Sylvester.precision){r++;break}}while(--t)}while(--i);return r},rk:function(){return this.rank()},augment:function(e){var t=e.elements||e;void 0===t[0][0]&&(t=Matrix.create(t).elements);var n,r,i,s=this.dup(),l=s.elements[0].length,o=s.elements.length,a=o,h=t[0].length;if(o!=t.length)return null;do{n=a-o,r=h;do{s.elements[n][l+(i=h-r)]=t[n][i]}while(--r)}while(--o);return s},inverse:function(){if(!this.isSquare()||this.isSingular())return null;var e,t,n,r,i,s,l,o=this.elements.length,a=o,h=this.augment(Matrix.I(o)).toRightTriangular(),c=h.elements[0].length,u=[];do{i=[],n=c,u[e=o-1]=[],s=h.elements[e][e];do{i.push(l=h.elements[e][r=c-n]/s),r>=a&&u[e].push(l)}while(--n);for(h.elements[e]=i,t=0;t<e;t++){i=[],n=c;do{i.push(h.elements[t][r=c-n]-h.elements[e][r]*h.elements[t][e])}while(--n);h.elements[t]=i}}while(--o);return Matrix.create(u)},inv:function(){return this.inverse()},round:function(){return this.map(function(e){return Math.round(e)})},snapTo:function(e){return this.map(function(t){return Math.abs(t-e)<=Sylvester.precision?e:t})},inspect:function(){var e=[],t=this.elements.length,n=t;do{e.push(Vector.create(this.elements[n-t]).inspect())}while(--t);return e.join("\n")},setElements:function(e){var t,n=e.elements||e;if(void 0!==n[0][0]){var r,i,s,l=n.length,o=l;this.elements=[];do{i=r=n[t=o-l].length,this.elements[t]=[];do{this.elements[t][s=i-r]=n[t][s]}while(--r)}while(--l);return this}var a=n.length,h=a;this.elements=[];do{this.elements.push([n[t=h-a]])}while(--a);return this}},Matrix.create=function(e){return(new Matrix).setElements(e)},Matrix.I=function(e){var t,n,r,i=[],s=e;do{i[t=s-e]=[],n=s;do{i[t][r=s-n]=t==r?1:0}while(--n)}while(--e);return Matrix.create(i)},Matrix.Diagonal=function(e){var t,n=e.length,r=n,i=Matrix.I(n);do{i.elements[t=r-n][t]=e[t]}while(--n);return i},Matrix.Rotation=function(e,t){if(!t)return Matrix.create([[Math.cos(e),-Math.sin(e)],[Math.sin(e),Math.cos(e)]]);var n=t.dup();if(3!=n.elements.length)return null;var r=n.modulus(),i=n.elements[0]/r,s=n.elements[1]/r,l=n.elements[2]/r,o=Math.sin(e),a=Math.cos(e),h=1-a;return Matrix.create([[h*i*i+a,h*i*s-o*l,h*i*l+o*s],[h*i*s+o*l,h*s*s+a,h*s*l-o*i],[h*i*l-o*s,h*s*l+o*i,h*l*l+a]])},Matrix.RotationX=function(e){var t=Math.cos(e),n=Math.sin(e);return Matrix.create([[1,0,0],[0,t,-n],[0,n,t]])},Matrix.RotationY=function(e){var t=Math.cos(e),n=Math.sin(e);return Matrix.create([[t,0,n],[0,1,0],[-n,0,t]])},Matrix.RotationZ=function(e){var t=Math.cos(e),n=Math.sin(e);return Matrix.create([[t,-n,0],[n,t,0],[0,0,1]])},Matrix.Random=function(e,t){return Matrix.Zero(e,t).map(function(){return Math.random()})},Matrix.Zero=function(e,t){var n,r,i=[],s=e;do{i[n=e-s]=[],r=t;do{i[n][t-r]=0}while(--r)}while(--s);return Matrix.create(i)},Line.prototype={eql:function(e){return this.isParallelTo(e)&&this.contains(e.anchor)},dup:function(){return Line.create(this.anchor,this.direction)},translate:function(e){var t=e.elements||e;return Line.create([this.anchor.elements[0]+t[0],this.anchor.elements[1]+t[1],this.anchor.elements[2]+(t[2]||0)],this.direction)},isParallelTo:function(e){if(e.normal)return e.isParallelTo(this);var t=this.direction.angleFrom(e.direction);return Math.abs(t)<=Sylvester.precision||Math.abs(t-Math.PI)<=Sylvester.precision},distanceFrom:function(e){if(e.normal)return e.distanceFrom(this);if(e.direction){if(this.isParallelTo(e))return this.distanceFrom(e.anchor);var t=this.direction.cross(e.direction).toUnitVector().elements,n=this.anchor.elements,r=e.anchor.elements;return Math.abs((n[0]-r[0])*t[0]+(n[1]-r[1])*t[1]+(n[2]-r[2])*t[2])}var i=e.elements||e,s=this.direction.elements,l=i[0]-(n=this.anchor.elements)[0],o=i[1]-n[1],a=(i[2]||0)-n[2],h=Math.sqrt(l*l+o*o+a*a);if(0===h)return 0;var c=(l*s[0]+o*s[1]+a*s[2])/h,u=1-c*c;return Math.abs(h*Math.sqrt(u<0?0:u))},contains:function(e){var t=this.distanceFrom(e);return null!==t&&t<=Sylvester.precision},liesIn:function(e){return e.contains(this)},intersects:function(e){return e.normal?e.intersects(this):!this.isParallelTo(e)&&this.distanceFrom(e)<=Sylvester.precision},intersectionWith:function(e){if(e.normal)return e.intersectionWith(this);if(!this.intersects(e))return null;var t=this.anchor.elements,n=this.direction.elements,r=e.anchor.elements,i=e.direction.elements,s=n[0],l=n[1],o=n[2],a=i[0],h=i[1],c=i[2],u=t[0]-r[0],m=t[1]-r[1],f=t[2]-r[2],d=a*a+h*h+c*c,g=s*a+l*h+o*c,v=((-s*u-l*m-o*f)*d/(s*s+l*l+o*o)+g*(a*u+h*m+c*f))/(d-g*g);return Vector.create([t[0]+v*s,t[1]+v*l,t[2]+v*o])},pointClosestTo:function(e){if(e.direction){if(this.intersects(e))return this.intersectionWith(e);if(this.isParallelTo(e))return null;var t=e.direction.elements,n=t[0],r=t[1],i=t[2],s=Vector.create([(u=(c=(o=this.direction.elements)[2])*n-(a=o[0])*i)*i-(m=a*r-(h=o[1])*n)*r,m*n-(f=h*i-c*r)*i,f*r-u*n]);return(l=Plane.create(e.anchor,s)).intersectionWith(this)}var l;if(this.contains(l=e.elements||e))return Vector.create(l);var o,a,h,c,u,m,f,d=this.anchor.elements,g=d[0],v=d[1],p=d[2],M=Vector.create([(h=(o=this.direction.elements)[1])*(u=(a=o[0])*(l[1]-v)-h*(l[0]-g))-(c=o[2])*(f=c*(l[0]-g)-a*((l[2]||0)-p)),c*(m=h*((l[2]||0)-p)-c*(l[1]-v))-a*u,a*f-h*m]),x=this.distanceFrom(l)/M.modulus();return Vector.create([l[0]+M.elements[0]*x,l[1]+M.elements[1]*x,(l[2]||0)+M.elements[2]*x])},rotate:function(e,t){void 0===t.direction&&(t=Line.create(t.to3D(),Vector.k));var n=Matrix.Rotation(e,t.direction).elements,r=t.pointClosestTo(this.anchor).elements,i=this.anchor.elements,s=this.direction.elements,l=r[0],o=r[1],a=r[2],h=i[0]-l,c=i[1]-o,u=i[2]-a;return Line.create([l+n[0][0]*h+n[0][1]*c+n[0][2]*u,o+n[1][0]*h+n[1][1]*c+n[1][2]*u,a+n[2][0]*h+n[2][1]*c+n[2][2]*u],[n[0][0]*s[0]+n[0][1]*s[1]+n[0][2]*s[2],n[1][0]*s[0]+n[1][1]*s[1]+n[1][2]*s[2],n[2][0]*s[0]+n[2][1]*s[1]+n[2][2]*s[2]])},reflectionIn:function(e){if(e.normal){var t=this.anchor.elements,n=this.direction.elements,r=t[0],i=t[1],s=t[2],l=n[0],o=n[1],a=n[2],h=this.anchor.reflectionIn(e).elements,c=r+l,u=i+o,m=s+a,f=e.pointClosestTo([c,u,m]).elements;return Line.create(h,[f[0]+(f[0]-c)-h[0],f[1]+(f[1]-u)-h[1],f[2]+(f[2]-m)-h[2]])}if(e.direction)return this.rotate(Math.PI,e);var d=e.elements||e;return Line.create(this.anchor.reflectionIn([d[0],d[1],d[2]||0]),this.direction)},setVectors:function(e,t){if(e=Vector.create(e),t=Vector.create(t),2==e.elements.length&&e.elements.push(0),2==t.elements.length&&t.elements.push(0),e.elements.length>3||t.elements.length>3)return null;var n=t.modulus();return 0===n?null:(this.anchor=e,this.direction=Vector.create([t.elements[0]/n,t.elements[1]/n,t.elements[2]/n]),this)}},Line.create=function(e,t){return(new Line).setVectors(e,t)},Line.X=Line.create(Vector.Zero(3),Vector.i),Line.Y=Line.create(Vector.Zero(3),Vector.j),Line.Z=Line.create(Vector.Zero(3),Vector.k),Plane.prototype={eql:function(e){return this.contains(e.anchor)&&this.isParallelTo(e)},dup:function(){return Plane.create(this.anchor,this.normal)},translate:function(e){var t=e.elements||e;return Plane.create([this.anchor.elements[0]+t[0],this.anchor.elements[1]+t[1],this.anchor.elements[2]+(t[2]||0)],this.normal)},isParallelTo:function(e){var t;return e.normal?(t=this.normal.angleFrom(e.normal),Math.abs(t)<=Sylvester.precision||Math.abs(Math.PI-t)<=Sylvester.precision):e.direction?this.normal.isPerpendicularTo(e.direction):null},isPerpendicularTo:function(e){var t=this.normal.angleFrom(e.normal);return Math.abs(Math.PI/2-t)<=Sylvester.precision},distanceFrom:function(e){if(this.intersects(e)||this.contains(e))return 0;if(e.anchor){var t=this.anchor.elements,n=e.anchor.elements,r=this.normal.elements;return Math.abs((t[0]-n[0])*r[0]+(t[1]-n[1])*r[1]+(t[2]-n[2])*r[2])}var i=e.elements||e;return t=this.anchor.elements,r=this.normal.elements,Math.abs((t[0]-i[0])*r[0]+(t[1]-i[1])*r[1]+(t[2]-(i[2]||0))*r[2])},contains:function(e){if(e.normal)return null;if(e.direction)return this.contains(e.anchor)&&this.contains(e.anchor.add(e.direction));var t=e.elements||e,n=this.anchor.elements,r=this.normal.elements;return Math.abs(r[0]*(n[0]-t[0])+r[1]*(n[1]-t[1])+r[2]*(n[2]-(t[2]||0)))<=Sylvester.precision},intersects:function(e){return void 0===e.direction&&void 0===e.normal?null:!this.isParallelTo(e)},intersectionWith:function(e){if(!this.intersects(e))return null;if(e.direction){var t=e.direction.elements,n=this.anchor.elements,r=((s=this.normal.elements)[0]*(n[0]-(l=e.anchor.elements)[0])+s[1]*(n[1]-l[1])+s[2]*(n[2]-l[2]))/(s[0]*t[0]+s[1]*t[1]+s[2]*t[2]);return Vector.create([l[0]+t[0]*r,l[1]+t[1]*r,l[2]+t[2]*r])}if(e.normal){for(var i=this.normal.cross(e.normal).toUnitVector(),s=this.normal.elements,l=this.anchor.elements,o=e.normal.elements,a=e.anchor.elements,h=Matrix.Zero(2,2),c=0;h.isSingular();)c++,h=Matrix.create([[s[c%3],s[(c+1)%3]],[o[c%3],o[(c+1)%3]]]);for(var u=h.inverse().elements,m=s[0]*l[0]+s[1]*l[1]+s[2]*l[2],f=o[0]*a[0]+o[1]*a[1]+o[2]*a[2],d=[u[0][0]*m+u[0][1]*f,u[1][0]*m+u[1][1]*f],g=[],v=1;v<=3;v++)g.push(c==v?0:d[(v+(5-c)%3)%3]);return Line.create(g,i)}},pointClosestTo:function(e){var t=e.elements||e,n=this.anchor.elements,r=this.normal.elements,i=(n[0]-t[0])*r[0]+(n[1]-t[1])*r[1]+(n[2]-(t[2]||0))*r[2];return Vector.create([t[0]+r[0]*i,t[1]+r[1]*i,(t[2]||0)+r[2]*i])},rotate:function(e,t){var n=Matrix.Rotation(e,t.direction).elements,r=t.pointClosestTo(this.anchor).elements,i=this.anchor.elements,s=this.normal.elements,l=r[0],o=r[1],a=r[2],h=i[0]-l,c=i[1]-o,u=i[2]-a;return Plane.create([l+n[0][0]*h+n[0][1]*c+n[0][2]*u,o+n[1][0]*h+n[1][1]*c+n[1][2]*u,a+n[2][0]*h+n[2][1]*c+n[2][2]*u],[n[0][0]*s[0]+n[0][1]*s[1]+n[0][2]*s[2],n[1][0]*s[0]+n[1][1]*s[1]+n[1][2]*s[2],n[2][0]*s[0]+n[2][1]*s[1]+n[2][2]*s[2]])},reflectionIn:function(e){if(e.normal){var t=this.anchor.elements,n=this.normal.elements,r=t[0],i=t[1],s=t[2],l=n[0],o=n[1],a=n[2],h=this.anchor.reflectionIn(e).elements,c=r+l,u=i+o,m=s+a,f=e.pointClosestTo([c,u,m]).elements;return Plane.create(h,[f[0]+(f[0]-c)-h[0],f[1]+(f[1]-u)-h[1],f[2]+(f[2]-m)-h[2]])}if(e.direction)return this.rotate(Math.PI,e);var d=e.elements||e;return Plane.create(this.anchor.reflectionIn([d[0],d[1],d[2]||0]),this.normal)},setVectors:function(e,t,n){if(null===(e=(e=Vector.create(e)).to3D()))return null;if(null===(t=(t=Vector.create(t)).to3D()))return null;if(void 0===n)n=null;else if(null===(n=(n=Vector.create(n)).to3D()))return null;var r,i,s=e.elements[0],l=e.elements[1],o=e.elements[2],a=t.elements[0],h=t.elements[1],c=t.elements[2];if(null!==n){var u=n.elements[0],m=n.elements[1],f=n.elements[2];if(0===(i=(r=Vector.create([(h-l)*(f-o)-(c-o)*(m-l),(c-o)*(u-s)-(a-s)*(f-o),(a-s)*(m-l)-(h-l)*(u-s)])).modulus()))return null;r=Vector.create([r.elements[0]/i,r.elements[1]/i,r.elements[2]/i])}else{if(0===(i=Math.sqrt(a*a+h*h+c*c)))return null;r=Vector.create([t.elements[0]/i,t.elements[1]/i,t.elements[2]/i])}return this.anchor=e,this.normal=r,this}},Plane.create=function(e,t,n){return(new Plane).setVectors(e,t,n)},Plane.XY=Plane.create(Vector.Zero(3),Vector.k),Plane.YZ=Plane.create(Vector.Zero(3),Vector.i),Plane.ZX=Plane.create(Vector.Zero(3),Vector.j),Plane.YX=Plane.XY,Plane.ZY=Plane.YZ,Plane.XZ=Plane.ZX;var $V=Vector.create,$M=Matrix.create,$L=Line.create,$P=Plane.create;$(document).ready(function(){});